policies:
  - name: security-baseline
    description: "Enforce security baseline for Roo Code modes"
    rules:
      - name: single-edit-tuple
        description: "Each mode must have exactly one edit tuple"
        query: "data.security.single_edit_tuple"
        type: deny
        message: "Multiple edit tuples can cause parser bugs"

      - name: no-forbidden-access
        description: "No mode can access forbidden security patterns"
        query: "data.security.no_forbidden_access"
        type: deny
        message: "Mode can access forbidden security-critical files"

      - name: issue-resolver-security
        description: "Issue resolver cannot access critical infrastructure"
        query: "data.security.issue_resolver_security"
        type: deny
        message: "Issue resolver has access to critical infrastructure files"

      - name: migration-specialist-restricted
        description: "Migration specialist limited to specific config files"
        query: "data.security.migration_specialist_restricted"
        type: deny
        message: "Migration specialist has overly broad config access"

data:
  security:
    forbidden_patterns:
      auth_files: ".*(auth|authentication|credentials)/.*"
      payment_files: ".*(payment|billing|checkout)/.*"
      security_files: ".*(security|secrets)/.*"
      admin_files: ".*(admin|superuser)/.*"

    mode_rules:
      issue-resolver:
        must_exclude: ["auth/", "payment/", "security/", "admin/"]
        enforcement: "fail_on_match"

      migration-specialist:
        allowed_config_paths: ["migration-config.", "flyway.conf", "liquibase.properties"]
        enforcement: "allowlist_only"

    structural_requirements:
      single_edit_tuple:
        enforced: true
        description: "Each mode must have exactly ONE edit tuple to avoid parser bugs"